name: Main
on:
  push:
    branches:
      - main

jobs:
  # linter:
  #   runs-on: ubuntu-latest
  #   environment: staging

  #   steps:
  #     - name: Checkout Code
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0

  #     - name: Lint Code Base
  #       uses: docker://github/super-linter:v4
  #       env:
  #         VALIDATE_ALL_CODEBASE: false
  #         VALIDATE_PYTHON: true
  #         VALIDATE_DOCKERFILE: true
  #         VALIDATE_GITHUB_ACTIONS: true
  #         VALIDATE_MARKDOWN: true
  #         DEFAULT_BRANCH: main
  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  # build:
  #   # needs: [linter]
  #   runs-on: ubuntu-latest
  #   environment: staging

  #   steps:
  #   - uses: actions/checkout@v2

  #   - name: Publish
  #     uses: netlify/actions/build@master
  #     env:
  #       GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  #       NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
  #       NETLIFY_CMD: npm run build
  #       NETLIFY_DIR: public
  publish:
    runs-on: ubuntu-latest
    environment: production

    steps:
    - uses: actions/checkout@master

    - name: Publish
      uses: netlify/actions/cli@master
      with:
        args: deploy --build --dir=public
      env:
        NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
        NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
